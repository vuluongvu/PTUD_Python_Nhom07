{% extends 'core/base.html' %} {% load static %} 
{% block title %}Tất cả sản phẩm - LapStore
{% endblock %} 

{% block extra_css %}
<style>
  @media (min-width: 769px) {
    .flash-grid.view-all-grid { grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); }
  }
</style>
{% endblock %}

{% block content %}
<div style="margin-top: -10px; margin-bottom: 20px">
  <p style="font-size: 13px; color: var(--text-sub)">
    <a href="{% url 'core:home' %}">Trang chủ</a>
    <i
      class="fa-solid fa-chevron-right"
      style="font-size: 10px; margin: 0 5px"
    ></i>
    Tất cả sản phẩm
  </p>
</div>

<div class="view-all-container">
  <!-- Sidebar Filter -->
  <aside class="sidebar">
    <!-- DJANGO: Dynamic Filters (Brands, Categories, etc.) -->
    <div class="sidebar-header-mobile">
      <h3>Bộ lọc</h3>
      <button class="sidebar-close">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>
    <div class="filter-group">
      <h3 class="filter-title">Khoảng giá</h3>
      <ul class="filter-list">
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Dưới 10
            triệu</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> 10 - 15
            triệu</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> 15 - 20
            triệu</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> 20 - 30
            triệu</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Trên 30
            triệu</label
          >
        </li>
      </ul>
    </div>

    <div class="filter-group">
      <h3 class="filter-title">Thương hiệu</h3>
      <ul class="filter-list">
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> MacBook</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Asus</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Dell</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> HP</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Lenovo</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Acer</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> MSI</label
          >
        </li>
      </ul>
    </div>

    <div class="filter-group">
      <h3 class="filter-title">Nhu cầu</h3>
      <ul class="filter-list">
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Gaming</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Văn phòng</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Đồ họa - Kỹ
            thuật</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Mỏng nhẹ</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Sinh viên</label
          >
        </li>
      </ul>
    </div>

    <div class="filter-group">
      <h3 class="filter-title">CPU</h3>
      <ul class="filter-list">
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Ryzen 7</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Core i5</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Core i7</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Ryzen 5</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Apple
            M1/M2</label
          >
        </li>
      </ul>
    </div>

    <div class="filter-group">
      <h3 class="filter-title">Khác</h3>
      <ul class="filter-list">
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> RTX 3000 Series</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> RTX 4000 Series </label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> RTX 5000 Series</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Amd Radeon</label
          >
        </li>
        <li>
          <label class="filter-label"
            ><input type="checkbox" class="filter-checkbox" /> Apple
            M1/M2</label
          >
        </li>
      </ul>
    </div>
  </aside>

  <div class="main-content">
    <!-- Header trang -->
    <div class="search-header-block">
      <div class="search-title">
        <h1>Tất cả sản phẩm</h1>
        <span class="search-count">Hiển thị 12 trên {{products|length}} sản phẩm</span>
      </div>

      <!-- Nút mở filter mobile -->
      <button class="mobile-filter-btn">
        <i class="fa-solid fa-filter"></i> Bộ lọc
      </button>

      <!-- Bộ lọc nhanh -->
      <div class="filter-bar">
    <a href="?sort=default" class="filter-btn">
        <i class="fa-solid fa-sort"></i> Mặc định
    </a>
    <a href="?sort=price_asc" class="filter-btn">
        <i class="fa-solid fa-arrow-up-1-9"></i> Giá thấp - cao
    </a>
    <a href="?sort=price_desc" class="filter-btn">
        <i class="fa-solid fa-arrow-down-9-1"></i> Giá cao - thấp
    </a>
</div>
    </div>

    <!-- Lưới sản phẩm -->
    <div class="flash-grid view-all-grid" style="margin-bottom: 40px;">
     

        {% for p in products %}
         <a href="{% url 'products:product-detail' p.slug %}">
            <article class="prod-card pod-card-view-all">
              <button class="btn-add-wishlist" title="Thêm vào yêu thích">
                <i class="fa-regular fa-heart"></i>
              </button>
              <span class="badge-sale">Hot</span>
              <div class="prod-img-wrap">
                <img src="{% if p.images.first %}{{ p.images.first.image_url }}{% else %}{% static 'core/img/placeholder.png' %}{% endif %}" alt="LG" />
              </div>
              <h3 class="prod-name">{{p.name}}</h3>
              <div class="prod-specs-box">
               {% if p.is_lap %}
                <span><i class="fa-solid fa-microchip"></i>{{p.laptop_config.cpu}}</span>
                <span><i class="fa-solid fa-vr-cardboard"></i>{{p.laptop_config.vga}}</span>
                {% else %}
                   <span
                  ><i class="fa-solid fa-copyright"></i>Brand: {{p.brand}}
                  </span
                >
                <span><i class="fa-solid fa-shield"></i>Bảo hành: {{p.warranty}}</span>
                {% endif %}
              </div>
              <div class="prod-footer">
                <div class="price-box">
                  <span class="price-current">{{p.price_vn}}</span
                  ><span class="price-old">{{p.discount_price_vn}}</span>
                </div>
                <button class="btn-buy-now">Mua ngay</button>
              </div>
            </article>
          </a>
           {% endfor %}
     
           

    </div>

    <!-- Phân trang -->
    <!-- DJANGO: Pagination Logic -->
    <div class="pagination" style="margin-top: 20px;">
      {% if page_obj.has_previous %}
      <a href="?page={{ page_obj.previous_page_number }}" class="page-link">
        <i class="fa-solid fa-chevron-left"></i>
      </a>
      {% endif %}

      {% for num in page_obj.paginator.page_range %}
        {% if page_obj.number == num %}
          <a href="#" class="page-link active">{{ num }}</a>
        {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
          <a href="?page={{ num }}" class="page-link">{{ num }}</a>
        {% endif %}
      {% endfor %}

      {% if page_obj.has_next %}
      <a href="?page={{ page_obj.next_page_number }}" class="page-link">
        <i class="fa-solid fa-chevron-right"></i>
      </a>
      {% endif %}
    </div>
  </div>
</div>

<!-- Overlay cho sidebar mobile -->
<div class="sidebar-overlay"></div>
{% endblock %}
