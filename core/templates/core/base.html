{% load static %}
<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <!-- SEO Meta Tags -->
    <meta
      name="description"
      content="{% block meta_description %}Hệ thống bán lẻ Laptop & PC hàng đầu{% endblock %}"
    />

    <title>{% block title %}LapStore - Công Nghệ Đỉnh Cao{% endblock %}</title>

    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="apple-touch-icon" sizes="57x57" href="{% static 'core/favicon/apple-icon-57x57.png' %}">
    <link rel="apple-touch-icon" sizes="60x60" href="{% static 'core/favicon/apple-icon-60x60.png' %}">
    <link rel="apple-touch-icon" sizes="72x72" href="{% static 'core/favicon/apple-icon-72x72.png' %}">
    <link rel="apple-touch-icon" sizes="76x76" href="{% static 'core/favicon/apple-icon-76x76.png' %}">
    <link rel="apple-touch-icon" sizes="114x114" href="{% static 'core/favicon/apple-icon-114x114.png' %}">
    <link rel="apple-touch-icon" sizes="120x120" href="{% static 'core/favicon/apple-icon-120x120.png' %}">
    <link rel="apple-touch-icon" sizes="144x144" href="{% static 'core/favicon/apple-icon-144x144.png' %}">
    <link rel="apple-touch-icon" sizes="152x152" href="{% static 'core/favicon/apple-icon-152x152.png' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'core/favicon/apple-icon-180x180.png' %}">
    <link rel="icon" type="image/png" sizes="192x192"  href="{% static 'core/favicon/android-icon-192x192.png' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'core/favicon/favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="96x96" href="{% static 'core/favicon/favicon-96x96.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'core/favicon/favicon-16x16.png' %}">
    <link rel="manifest" href="{% static 'core/favicon/manifest.json' %}">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="{% static 'core/favicon/ms-icon-144x144.png' %}">
    <meta name="theme-color" content="#ffffff">

    <!-- CSS Files -->
    <link rel="stylesheet" href="{% static 'core/css/style.css' %}" />
    <link rel="stylesheet" href="{% static 'core/css/responsive.css' %}" />

    {% block extra_css %}{% endblock %}
  </head>
  <body>
    <!-- HEADER (Dùng chung) -->
    {% block header %}
    <header>
      <div class="container">
        <nav class="nav-island">
          <div class="nav-left">
            <a href="" class="logo">
              <i class="fa-brands fa-shopify" style="color: #ff1a1a;"></i>
             <span>LapStore</span>
            </a>
            <!-- Desktop Category Dropdown -->
            <div class="cat-menu-wrapper">
              <div class="cat-menu-btn">
                <i class="fa-solid fa-bars"></i> Danh mục
              </div>
              <div class="cat-dropdown">
                <div class="mega-menu-grid">
                  <!-- Cột 1: Laptop -->
                  <div class="mega-col">
                    <h3 class="mega-title"><i class="fa-solid fa-laptop"></i> Laptop</h3>
                    <a href="#" class="mega-link">MacBook Air / Pro</a>
                    <a href="#" class="mega-link">Laptop Gaming</a>
                    <a href="#" class="mega-link">Laptop Văn Phòng</a>
                    <a href="#" class="mega-link">Laptop Đồ Họa</a>
                    <a href="#" class="mega-link">Surface</a>
                  </div>
                  
                  <!-- Cột 2: PC & Màn hình -->
                  <div class="mega-col">
                    <h3 class="mega-title"><i class="fa-solid fa-desktop"></i> PC & Màn Hình</h3>
                    <a href="#" class="mega-link">PC Gaming</a>
                    <a href="#" class="mega-link">PC Workstation</a>
                    <a href="#" class="mega-link">PC Văn Phòng</a>
                    <a href="#" class="mega-link">Màn hình Gaming</a>
                    <a href="#" class="mega-link">Màn hình Đồ Họa</a>
                  </div>

                  <!-- Cột 3: Linh Kiện -->
                  <div class="mega-col">
                    <h3 class="mega-title"><i class="fa-solid fa-microchip"></i> Linh Kiện PC</h3>
                    <a href="#" class="mega-link">CPU - Vi xử lý</a>
                    <a href="#" class="mega-link">VGA - Card màn hình</a>
                    <a href="#" class="mega-link">Mainboard - Bo mạch</a>
                    <a href="#" class="mega-link">RAM - Bộ nhớ trong</a>
                    <a href="#" class="mega-link">SSD / HDD</a>
                  </div>

                  <!-- Cột 4: Phụ Kiện -->
                  <div class="mega-col">
                    <h3 class="mega-title"><i class="fa-solid fa-headset"></i> Phụ Kiện & Gear</h3>
                    <a href="#" class="mega-link">Chuột Gaming</a>
                    <a href="#" class="mega-link">Bàn phím cơ</a>
                    <a href="#" class="mega-link">Tai nghe</a>
                    <a href="#" class="mega-link">Ghế công thái học</a>
                    <a href="#" class="mega-link">Thiết bị mạng</a>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Search Form -->
          <form class="search-box" action="{% url 'products:search-results' %}" method="GET">
            <input
              type="text"
              name="q"
              placeholder="Tìm kiếm Laptop, Linh kiện..."
              autocomplete="off"
            />
            <button type="submit" class="search-btn">
              <i class="fa-solid fa-magnifying-glass"></i>
            </button>
            <!-- Search Suggestions Container (JS fills this) -->
          </form>

          <!-- User Actions (Desktop) -->
          <div class="nav-actions">
    <a href="{% url 'orders:wishlist' %}" class="action-btn">
        <i class="fa-regular fa-heart"></i>
    </a>
    
    {% if user.is_authenticated %}
    <a href="{% url 'users:profile' %}" class="action-btn">
        <img src="{% if user_avatar_url %}{{ user_avatar_url }}
        {% else %}https://ui-avatars.com/api/?name={{ user.username }}
         {% endif %}" alt="Avatar">
    </a>
    {% else %}
    <a href="{% url 'users:login' %}" class="action-btn">
        <i class="fa-regular fa-user"></i>
    </a>
    {% endif %}

    <a href="{% url 'orders:cart' %}" class="action-btn">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.8" stroke="currentColor" width="1.2em" height="1.2em" class="fa-regular">
  <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
</svg>
        <span class="badge-dot"></span>
    </a>
</div>
              <!-- DJANGO: Show if cart_items > 0 -->
            </a>
          </div>
        </nav>
      </div>
    </header>
    {% endblock %}
{% if messages %}
  <!-- Các thông báo sẽ được xử lý bằng SweetAlert2 ở cuối file -->
{% endif %}
    <!-- MOBILE MENU SIDEBAR (Dùng chung) -->
    {% block mobile_menu %}
    <aside class="mobile-menu">
      <div class="mobile-menu-header">
        <h3>Danh mục sản phẩm</h3>
        <button class="mobile-menu-close">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>
      <ul class="mobile-menu-list">
        <!-- Mobile Item 1 -->
        <li class="m-menu-group">
          <div class="m-menu-title"><i class="fa-solid fa-laptop"></i> Laptop</div>
          <a href="#" class="m-menu-link">MacBook</a>
          <a href="#" class="m-menu-link">Laptop Gaming</a>
          <a href="#" class="m-menu-link">Laptop Văn Phòng</a>
        </li>
        <!-- Mobile Item 2 -->
        <li class="m-menu-group">
          <div class="m-menu-title"><i class="fa-solid fa-desktop"></i> PC & Màn Hình</div>
          <a href="#" class="m-menu-link">PC Gaming / Workstation</a>
          <a href="#" class="m-menu-link">Màn hình máy tính</a>
        </li>
        <!-- Mobile Item 3 -->
        <li class="m-menu-group">
          <div class="m-menu-title"><i class="fa-solid fa-microchip"></i> Linh Kiện</div>
          <a href="#" class="m-menu-link">CPU / VGA / Mainboard</a>
          <a href="#" class="m-menu-link">RAM / SSD</a>
        </li>
        <!-- Mobile Item 4 -->
        <li class="m-menu-group">
          <div class="m-menu-title"><i class="fa-solid fa-headset"></i> Phụ Kiện</div>
          <a href="#" class="m-menu-link">Chuột / Phím / Tai nghe</a>
        </li>
      </ul>
    </aside>
    <div class="mobile-menu-overlay"></div>
    {% endblock %}

    <!-- MOBILE BOTTOM NAV (Dùng chung) -->
    {% block mobile_bottom_nav %}
    <div class="mobile-bottom-nav">
      <a href="{% url 'core:home'%}" class="nav-item {% block nav_home_active %}{% endblock %}">
        <i class="fa-solid fa-house"></i><span>Trang chủ</span>
      </a>
      <button class="nav-item btn-mobile-menu">
        <i class="fa-solid fa-layer-group"></i><span>Danh mục</span>
      </button>

      <a
        href="{% url 'orders:cart' %}"
        class="nav-item {% block nav_cart_active %}{% endblock %}"
      >
        <i class="fa-solid fa-cart-shopping"></i>
        <span class="cart-count-mobile">3</span>
        <!-- DJANGO: Cart count -->
        <span>Giỏ hàng</span>
      </a>
      
    <a href="{% if user.is_authenticated %}{% url 'users:profile' %}{% else %}{% url 'users:login' %}{% endif %}"
   class="nav-item {% block nav_user_active %}{% endblock %}">
    <i class="fa-regular fa-user"></i>
    <span>
      {% if user.is_authenticated %}Tài khoản{% else %}Đăng nhập{% endif %}
    </span>
    </a>
    </div>
    {% endblock %}

    <!-- MAIN CONTENT BLOCK -->
    <main class="container">
      {% block content %}
      <!-- Nội dung riêng của từng trang sẽ nằm ở đây -->
      {% endblock %}
    </main>

    <!-- FOOTER (Dùng chung) -->
    {% block footer %}
    <footer>
      <div class="container foot-grid">
        <div>
          <h3 class="foot-title" style="color: var(--primary)">
            <i class="fa-brands fa-shopify" style="color: #ff1a1a;"></i>LapStore</h3>
          <p style="font-size: 14px; color: var(--text-sub)">
            Hệ thống bán lẻ kỹ thuật số chính hãng hàng đầu Việt Nam.
          </p>
          <div
            style="margin-top: 20px; display: flex; gap: 16px; font-size: 20px"
          >
            <i class="fa-brands fa-facebook" style="color: #1877f2"></i>
            <i class="fa-brands fa-youtube" style="color: red"></i>
            <i class="fa-brands fa-tiktok" style="color: black"></i>
          </div>
        </div>
        <nav>
          <h4 class="foot-title">Sản phẩm</h4>
          <ul>
            <li><a href="#" class="foot-link">Laptop Gaming</a></li>
            <li><a href="#" class="foot-link">MacBook</a></li>
            <li><a href="#" class="foot-link">Linh Kiện PC</a></li>
            <li><a href="#" class="foot-link">Màn Hình</a></li>
          </ul>
        </nav>
        <nav>
          <h4 class="foot-title">Hỗ trợ</h4>
          <ul>
            <li><a href="#" class="foot-link">Tra cứu đơn hàng</a></li>
            <li><a href="#" class="foot-link">Chính sách bảo hành</a></li>
            <li><a href="#" class="foot-link">Chính sách đổi trả</a></li>
            <li><a href="#" class="foot-link">Giao hàng & Thanh toán</a></li>
          </ul>
        </nav>
        <div>
          <h4 class="foot-title">Tổng đài hỗ trợ</h4>
          <div class="hotline-box">
            <span class="hotline-desc">Mua hàng (8:00 - 22:00)</span>
            <a href="tel:18183636" class="hotline-num">1900 8888</a>
          </div>
          <div class="hotline-box">
            <span class="hotline-desc">Khiếu nại (8:00 - 21:00)</span>
            <a href="tel:18183636" class="hotline-num">1900 8888</a>
          </div>
          <div style="margin-top: 20px">
            <span class="foot-link">Phương thức thanh toán:</span>
            <div
              style="
                display: flex;
                gap: 10px;
                margin-top: 5px;
                font-size: 24px;
                color: #555;
              "
            >
              <i class="fa-brands fa-cc-visa"></i>
              <i class="fa-brands fa-cc-mastercard"></i>
              <i class="fa-solid fa-money-bill-wave"></i>
            </div>
          </div>
        </div>
      </div>
      <div class="copyright">
        © 2026 Designed by nhom 07 - LapStore. All rights reserved.
      </div>
    </footer>
    {% endblock %}

    <button id="backToTop" class="back-to-top" title="Lên đầu trang">
      <i class="fa-solid fa-arrow-up"></i>
    </button>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    {% if messages %}
      <script>
        document.addEventListener('DOMContentLoaded', function() {
          {% for message in messages %}
            Swal.fire({
              toast: true,
              position: 'top-end',
              icon: '{{ message.tags }}', // success, error, warning, info
              title: '{{ message|escapejs }}',
              showConfirmButton: false,
              timer: 3500,
              timerProgressBar: true,
              didOpen: (toast) => {
                toast.addEventListener('mouseenter', Swal.stopTimer)
                toast.addEventListener('mouseleave', Swal.resumeTimer)
              }
            });
          {% endfor %}
        });
      </script>
    {% endif %}

    <script src="{% static 'core/js/main.js' %}"></script>
    {% block extra_js %}{% endblock %} 
  </body>
</html>
